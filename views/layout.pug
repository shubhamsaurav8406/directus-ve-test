doctype html
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
    script(src='https://unpkg.com/observe-rect@1.0.1/dist/observe-rect.min.js')
    script(src='https://unpkg.com/@directus/visual-editing@1.2.0/dist/visual-editing.js')
  body
    nav
      if user
        .user-info
          span Welcome, #{user.first_name || user.email}!
          span &nbsp;|&nbsp;
          a(href='/') Home
          span &nbsp;|&nbsp;
          a(href='/logout') Logout
      else
        a(href='/login') Login
    
    script(type="module").
      class BrickText extends HTMLElement {
        connectedCallback() {
          this.innerHTML = `<div>${this.getAttribute('data-text')}</div>`;
        }
      }
      customElements.define('brick-text', BrickText);

      class BrickImage extends HTMLElement {
        connectedCallback() {
          const src = this.getAttribute('data-src');
          this.innerHTML = `<img src="${src}" alt="Brick Image" />`;
        }
      }
      customElements.define('brick-image', BrickImage);
    
    block content
    
    script(type="module").
      document.addEventListener('DOMContentLoaded', function () {
        if (window.DirectusVisualEditing && typeof window.DirectusVisualEditing.apply === 'function') {
          window.DirectusVisualEditing.apply({ directusUrl: '#{DIRECTUS_URL}' });
        }
      });
